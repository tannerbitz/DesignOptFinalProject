function A = A_fsrg(C,Fz_f,Fz_r,Iz,R,delta,lf,lr,m,mu,omegaB,varphi,vx,vy)
A = [ 0, 0, - vy*cos(varphi) - vx*sin(varphi),                                                                                                                                                                                                                                                                                                                                                                                                                              cos(varphi),                                                                                                                                                                                                                                                                                                                                                                                     -sin(varphi),                                                                                                                                                                                                                                                                                                                                                                                                           0;
      0, 0,   vx*cos(varphi) - vy*sin(varphi),                                                                                                                                                                                                                                                                                                                                                                                                                              sin(varphi),                                                                                                                                                                                                                                                                                                                                                                                      cos(varphi),                                                                                                                                                                                                                                                                                                                                                                                                           0;
      0, 0,                                 0,                                                                                                                                                                                                                                                                                                                                                                                                                                        0,                                                                                                                                                                                                                                                                                                                                                                                                0,                                                                                                                                                                                                                                                                                                                                                                                                           1;
      0, 0,                                 0,                                                                                                                                                                                                                                                                 -(2*Fz_f*mu*dirac(atan((vy + lr*omegaB)/(vx + 1/100000000)) - delta)*sin(delta)*(vy + lr*omegaB))/(m*((vy + lr*omegaB)^2/(vx + 1/100000000)^2 + 1)*(vx + 1/100000000)^2),                                                                                                                                                                                                                                (m*omegaB + (2*Fz_f*mu*dirac(atan((vy + lr*omegaB)/(vx + 1/100000000)) - delta)*sin(delta))/(((vy + lr*omegaB)^2/(vx + 1/100000000)^2 + 1)*(vx + 1/100000000)))/m,                                                                                                                                                                                                                                            (m*vy + (2*Fz_f*lr*mu*dirac(atan((vy + lr*omegaB)/(vx + 1/100000000)) - delta)*sin(delta))/(((vy + lr*omegaB)^2/(vx + 1/100000000)^2 + 1)*(vx + 1/100000000)))/m;
      0, 0,                                 0, ((C*(vy - lf*omegaB))/(vx + 1/100000000)^2 - m*omegaB - (C^3*((2*R)/3 - 1)*(vy - lf*omegaB)^3)/(3*Fz_r^2*mu^2*(vx + 1/100000000)^4) + (2*Fz_f*mu*dirac(atan((vy + lr*omegaB)/(vx + 1/100000000)) - delta)*cos(delta)*(vy + lr*omegaB))/(((vy + lr*omegaB)^2/(vx + 1/100000000)^2 + 1)*(vx + 1/100000000)^2) + (C^2*(vy - lf*omegaB)^2*(R - 2))/(3*Fz_r*mu*(vx + 1/100000000)^3*((C^2*(vy - lf*omegaB)^2)/(vx + 1/100000000)^2)^(1/2)))/m,         -(C/(vx + 1/100000000) - (C^3*((2*R)/3 - 1)*(vy - lf*omegaB)^2)/(3*Fz_r^2*mu^2*(vx + 1/100000000)^3) + (2*Fz_f*mu*dirac(atan((vy + lr*omegaB)/(vx + 1/100000000)) - delta)*cos(delta))/(((vy + lr*omegaB)^2/(vx + 1/100000000)^2 + 1)*(vx + 1/100000000)) + (C^2*(2*vy - 2*lf*omegaB)*(R - 2))/(6*Fz_r*mu*(vx + 1/100000000)^2*((C^2*(vy - lf*omegaB)^2)/(vx + 1/100000000)^2)^(1/2)))/m,   -(m*vx - (C*lf)/(vx + 1/100000000) + (C^3*lf*((2*R)/3 - 1)*(vy - lf*omegaB)^2)/(3*Fz_r^2*mu^2*(vx + 1/100000000)^3) + (2*Fz_f*lr*mu*dirac(atan((vy + lr*omegaB)/(vx + 1/100000000)) - delta)*cos(delta))/(((vy + lr*omegaB)^2/(vx + 1/100000000)^2 + 1)*(vx + 1/100000000)) - (C^2*lf*(vy - lf*omegaB)*(R - 2))/(3*Fz_r*mu*(vx + 1/100000000)^2*((C^2*(vy - lf*omegaB)^2)/(vx + 1/100000000)^2)^(1/2)))/m;
      0, 0,                                 0,  -(lr*((C*(vy - lf*omegaB))/(vx + 1/100000000)^2 - (C^3*((2*R)/3 - 1)*(vy - lf*omegaB)^3)/(3*Fz_r^2*mu^2*(vx + 1/100000000)^4) + (C^2*(vy - lf*omegaB)^2*(R - 2))/(3*Fz_r*mu*(vx + 1/100000000)^3*((C^2*(vy - lf*omegaB)^2)/(vx + 1/100000000)^2)^(1/2))) - (2*Fz_f*lf*mu*dirac(atan((vy + lr*omegaB)/(vx + 1/100000000)) - delta)*cos(delta)*(vy + lr*omegaB))/(((vy + lr*omegaB)^2/(vx + 1/100000000)^2 + 1)*(vx + 1/100000000)^2))/Iz, (lr*(C/(vx + 1/100000000) - (C^3*((2*R)/3 - 1)*(vy - lf*omegaB)^2)/(3*Fz_r^2*mu^2*(vx + 1/100000000)^3) + (C^2*(2*vy - 2*lf*omegaB)*(R - 2))/(6*Fz_r*mu*(vx + 1/100000000)^2*((C^2*(vy - lf*omegaB)^2)/(vx + 1/100000000)^2)^(1/2))) - (2*Fz_f*lf*mu*dirac(atan((vy + lr*omegaB)/(vx + 1/100000000)) - delta)*cos(delta))/(((vy + lr*omegaB)^2/(vx + 1/100000000)^2 + 1)*(vx + 1/100000000)))/Iz, -(lr*((C*lf)/(vx + 1/100000000) - (C^3*lf*((2*R)/3 - 1)*(vy - lf*omegaB)^2)/(3*Fz_r^2*mu^2*(vx + 1/100000000)^3) + (C^2*lf*(vy - lf*omegaB)*(R - 2))/(3*Fz_r*mu*(vx + 1/100000000)^2*((C^2*(vy - lf*omegaB)^2)/(vx + 1/100000000)^2)^(1/2))) + (2*Fz_f*lf*lr*mu*dirac(atan((vy + lr*omegaB)/(vx + 1/100000000)) - delta)*cos(delta))/(((vy + lr*omegaB)^2/(vx + 1/100000000)^2 + 1)*(vx + 1/100000000)))/Iz];
 

end